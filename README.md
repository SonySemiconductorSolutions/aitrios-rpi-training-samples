# imx500_zoo

## Notice

### Security

Please read the Site Policy of GitHub and understand the usage conditions.

## Overview

The IMX500 Model Zoo is a sample script collection to train and quantize models.
You can deploy the quantized model generated by this script to the IMX500 by converting it with the SDSP converter.

## Requirements
* Ubuntu 22.04
* Python 3.10

## Setup

Run the following command in an environment where Python is installed

Clone this repository.

``` bash
git clone https://github.com/SonySemiconductorSolutions/aitrios-rpi-training-samples.git
```

Install package.

``` bash
pip install .
```

## Training and quantization

Run the following command.  
Training and quantization will be performed, and a quantized model will be generated.  

``` bash
cd samples
imx500_zoo <inifile name>
```

Example:  

``` bash
imx500_zoo nanodet_plus_as_is.ini
```

Once training and quantization are complete, a model is generated under samples/model

```
./samples/model/nanodet_plus_as_is
    nanodet_plus_as_is.keras            : float model
    nanodet_plus_as_is_quantized.keras  : quantized model
```

## Using Docker

Install the nvidia-container-toolkit, as instructed on the [Installing the NVIDIA Container Toolkit](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html).

Build the docker image

``` bash
source docker-build.sh
```

Run the following command to run and login the imx500-zoo container.

``` bash
source docker-run.sh
```

Run the following command in the imx500-zoo container to install the package

``` bash
cd /work
pip install .
```

Run the following command in the imx500-zoo container.
Training and quantization will be performed, and a quantized model will be generated.

Example:  

``` bash
cd /work/samples
imx500_zoo nanodet_plus_as_is.ini
```

## Model List

| ini file | task| dataset | model | Retraining Model |
|---|---|---|---|:---:|
|mobilenet_v2_as_is.ini|classification|[ImageNet](https://image-net.org/)|mobilenet_v2|-|
|mobilenet_v2_cifar10.ini|classification|[CIFAR-10](https://www.cs.toronto.edu/~kriz/cifar.html)|mobilenet_v2|☑|
|mobilenet_v2_card.ini|classification|[card_clasification](https://github.com/SonySemiconductorSolutions/aitrios-rpi-dataset-sample/blob/main/card_classification.zip)|mobilenet_v2|☑|
|nanodet_plus_as_is.ini|object_detection|[COCO-Val2017](https://cocodataset.org/#home)|nanodet_plus|-|
|nanodet_plus_card.ini|object_detection|[card_detection](https://github.com/SonySemiconductorSolutions/aitrios-rpi-dataset-sample/blob/main/card_detection.zip)|nanodet_plus|☑|

## License

[LICENSE](LICENSE)

## See also
- ["**FAQ**"](./FAQ.md)

